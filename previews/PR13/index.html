<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · PositiveIntegrators.jl</title><meta name="title" content="Home · PositiveIntegrators.jl"/><meta property="og:title" content="Home · PositiveIntegrators.jl"/><meta property="twitter:title" content="Home · PositiveIntegrators.jl"/><meta name="description" content="Documentation for PositiveIntegrators.jl."/><meta property="og:description" content="Documentation for PositiveIntegrators.jl."/><meta property="twitter:description" content="Documentation for PositiveIntegrators.jl."/><meta property="og:url" content="https://SKopecz.github.io/PositiveIntegrators.jl/stable/"/><meta property="twitter:url" content="https://SKopecz.github.io/PositiveIntegrators.jl/stable/"/><link rel="canonical" href="https://SKopecz.github.io/PositiveIntegrators.jl/stable/"/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>PositiveIntegrators.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Installation"><span>Installation</span></a></li><li><a class="tocitem" href="#Basic-examples"><span>Basic examples</span></a></li><li><a class="tocitem" href="#Referencing"><span>Referencing</span></a></li><li><a class="tocitem" href="#License-and-contributing"><span>License and contributing</span></a></li></ul></li><li><a class="tocitem" href="api_reference/">API reference</a></li><li><a class="tocitem" href="contributing/">Contributing</a></li><li><a class="tocitem" href="license/">License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SKopecz/PositiveIntegrators.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SKopecz/PositiveIntegrators.jl/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="PositiveIntegrators.jl"><a class="docs-heading-anchor" href="#PositiveIntegrators.jl">PositiveIntegrators.jl</a><a id="PositiveIntegrators.jl-1"></a><a class="docs-heading-anchor-permalink" href="#PositiveIntegrators.jl" title="Permalink"></a></h1><p>The <a href>Julia</a> library <a href="https://github.com/ranocha/PositiveIntegrators.jl">PositiveIntegrators.jl</a> provides several time integration methods developed to preserve the positivity of numerical solutions.</p><p>TODO: More introduction etc.</p><h2 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h2><p>TODO: PositiveIntegrators.jl has to be registered - up to now, it is not!</p><p><a href="https://github.com/SKopecz/PositiveIntegrators.jl">PositiveIntegrators.jl</a> is a registered Julia package. Thus, you can install it from the Julia REPL via</p><pre><code class="language-julia hljs">julia&gt; using Pkg; Pkg.add(&quot;PositiveIntegrators&quot;)</code></pre><p>If you want to update PositiveIntegrators.jl, you can use</p><pre><code class="language-julia hljs">julia&gt; using Pkg; Pkg.update(&quot;PositiveIntegrators&quot;)</code></pre><p>As usual, if you want to update PositiveIntegrators.jl and all other packages in your current project, you can execute</p><pre><code class="language-julia hljs">julia&gt; using Pkg; Pkg.update()</code></pre><h2 id="Basic-examples"><a class="docs-heading-anchor" href="#Basic-examples">Basic examples</a><a id="Basic-examples-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-examples" title="Permalink"></a></h2><h3 id="Modified-Patankar-Runge-Kutta-schemes"><a class="docs-heading-anchor" href="#Modified-Patankar-Runge-Kutta-schemes">Modified Patankar-Runge-Kutta schemes</a><a id="Modified-Patankar-Runge-Kutta-schemes-1"></a><a class="docs-heading-anchor-permalink" href="#Modified-Patankar-Runge-Kutta-schemes" title="Permalink"></a></h3><p>Modified Patankar-Runge-Kutta (MPRK) schemes are unconditionally positive and conservative time integration schemes for the solution of positive and conservative ODE systems. The formulation of these methods is based on the representation of the ODE system as a so-called production-destruction system (PDS).</p><h4 id="Production-destruction-systems-(PDS)"><a class="docs-heading-anchor" href="#Production-destruction-systems-(PDS)">Production-destruction systems (PDS)</a><a id="Production-destruction-systems-(PDS)-1"></a><a class="docs-heading-anchor-permalink" href="#Production-destruction-systems-(PDS)" title="Permalink"></a></h4><p>The formulation of MPRK schemes requires the ODE system to be represented as a production-destruction system (PDS). A PDS takes the general form</p><p class="math-container">\[    y_i&#39;(t) = \sum_{j=1}^N \bigl(p_{ij}(t,\boldsymbol y) - d_{ij}(t,\boldsymbol y)\bigr),\quad i=1,\dots,N,\]</p><p>where <span>$\boldsymbol y=(y_1,\dots,y_n)^T$</span> is the vector of unknowns and the production terms <span>$p_{ij}(t,\boldsymbol y)$</span> as well as the destruction terms <span>$d_{ij}(t,\boldsymbol y)$</span> must be positive for all <span>$i,j=1,\dots,N$</span>. The meaning behind <span>$p_{ij}$</span> and <span>$d_{ij}$</span> is as follows:</p><ul><li><span>$p_{ij}$</span> with <span>$i\ne j$</span> represents the sum of all positive terms which  appear in equation <span>$i$</span> with a positive sign and in equation <span>$j$</span> with a negative sign.</li><li><span>$d_{ij}$</span> with <span>$i\ne j$</span> represents the sum of all positive terms which  appear in equation <span>$i$</span> with a negative sign and in equation <span>$j$</span> with a positive sign.</li><li><span>$p_{ii}$</span> represents the sum of all positive terms  which appear in    equation <span>$i$</span> and don&#39;t have a negative counterpart.</li><li><span>$d_{ii}$</span> represents the sum of all negative terms which appear in    equation <span>$i$</span> and don&#39;t have a positive counterpart.</li></ul><p>Please note that the above naming convention leads to <span>$p_{ij} = d_{ji}$</span> for <span>$i≠ j$</span>.</p><p>To illustrate the indexing, we consider the fictitious ODE system</p><p class="math-container">\[\begin{aligned}
y_1&#39; &amp;= y_1y_3^2 + 1-e^{-y_3} - y_1 y_2 - y_1, \\
y_2&#39; &amp;= y_1y_2 + y_2 + y_1^2,\\
y_3&#39;&amp;=-y_1y_3^2-(1-e^{-y_3}).
\end{aligned}\]</p><p>Under the assumptions <span>$y_1,y_2,y_3&gt;0$</span>, the above naming scheme results in</p><p class="math-container">\[\begin{aligned}
p_{13}(t,\boldsymbol y) &amp;= d_{31}(t,\boldsymbol y) = y_1y_3^2 + 1-e^{-y_3},\\
p_{21}(t,\boldsymbol y) &amp;= d_{21}(t,\boldsymbol y) = y_1 y_2,\\
d_{11}(t,\boldsymbol y) &amp;= y_1,\\
p_{22}(t,\boldsymbol y) &amp;= y_2 + y_1^2,
\end{aligned}\]</p><p>where the missing production and destruction terms are set to zero.</p><p>One specific example of a PDS are the Lotka–Volterra equations</p><p class="math-container">\[x&#39; = α x - β x y,\quad
y&#39; = β x y - γ y,\]</p><p>with </p><p class="math-container">\[p_{11}(x,y) = α x,\quad
p_{21}(x,y) = d_{12}(x, y) = β x y,\quad
d_{22}(x,y) = γ y,\]</p><p>where we assume <span>$x,y&gt;0$</span> as well as <span>$\alpha,\beta,\gamma&gt;0$</span>.</p><p>In terms of implementation, a PDS is completely described by the square matrix <span>$(p_{ij})_{i,j=1,\dots,N}$</span> and the vector <span>$(d_{ii})_{i=1,\dots,N}$</span>. </p><h4 id="Conservative-production-destruction-systems"><a class="docs-heading-anchor" href="#Conservative-production-destruction-systems">Conservative production-destruction systems</a><a id="Conservative-production-destruction-systems-1"></a><a class="docs-heading-anchor-permalink" href="#Conservative-production-destruction-systems" title="Permalink"></a></h4><p>A PDS with </p><p class="math-container">\[  p_{ii}(t,\boldsymbol y)=d_{ii}(t,\boldsymbol y)=0\]</p><p>for <span>$i=1,\dots,N$</span> is called conservative. In this case we have</p><p class="math-container">\[\frac{d}{dt}\sum_{i=1}^N y_i=\sum_{i=1}^N y_i&#39; = \sum_{\mathclap{i,j=1,\, i≠ j}}^N \bigl(p_{ij}(t,\boldsymbol y) - d_{ij}(t,\boldsymbol y)\bigr)= \sum_{\mathclap{i,j=1,\, i≠ j}}^N \bigl(p_{ij}(t,\boldsymbol y) - p_{ji}(t,\boldsymbol y)\bigr) = 0.\]</p><p>As a consequence the sum of state variables remains constant over time, i.e.</p><p class="math-container">\[\sum_{i=1}^N y_i(t) = \sum_{i=1}^N y_i(0) \]</p><p>for all times <span>$t&gt;0$</span>.</p><p>A specific example of a conservative PDS is the SIR model</p><p class="math-container">\[S&#39; = -\frac{β S I}{N},\quad I&#39;= \frac{β S I}{N} - γ I,\quad R&#39;=γ I,\]</p><p>with</p><p class="math-container">\[p_{21}(S,I,R) = d_{12}(S,I,R) = \frac{β S I}{N},\quad p_{32}(S,I,R) = d_{23}(S,I,R) = γ I\]</p><p>and <span>$S,I,R&gt;0$</span>, <span>$N=S+I+R$</span> and <span>$\beta,\gamma&gt;0$</span>.</p><p>In terms of implementation, a conservative PDS is completely described by the square matrix <span>$(p_{ij})_{i,j=1,\dots,N}$</span>. There is no need for an additional vector to store destruction terms since we have <span>$d_{ij} = p_{ji}$</span>. </p><h2 id="Referencing"><a class="docs-heading-anchor" href="#Referencing">Referencing</a><a id="Referencing-1"></a><a class="docs-heading-anchor-permalink" href="#Referencing" title="Permalink"></a></h2><p>If you use <a href="https://github.com/ranocha/PositiveIntegrators.jl">PositiveIntegrators.jl</a> for your research, please cite it using the bibtex entry</p><pre><code class="language-bibtex hljs">@misc{PositiveIntegrators.jl,
  title={{PositiveIntegrators.jl}: {A} {J}ulia library of positivity-preserving
         time integration methods},
  author={Kopecz, Stefan and Ranocha, Hendrik and contributors},
  year={2023},
  doi={TODO},
  url={https://github.com/SKopecz/PositiveIntegrators.jl}
}</code></pre><h2 id="License-and-contributing"><a class="docs-heading-anchor" href="#License-and-contributing">License and contributing</a><a id="License-and-contributing-1"></a><a class="docs-heading-anchor-permalink" href="#License-and-contributing" title="Permalink"></a></h2><p>This project is licensed under the MIT license (see <a href="license/#License">License</a>). Since it is an open-source project, we are very happy to accept contributions from the community. Please refer to the section <a href="contributing/#Contributing">Contributing</a> for more details.</p></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="api_reference/">API reference »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.1.2 on <span class="colophon-date" title="Friday 10 November 2023 09:03">Friday 10 November 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
