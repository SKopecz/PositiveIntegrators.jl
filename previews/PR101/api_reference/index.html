<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API reference · PositiveIntegrators.jl</title><meta name="title" content="API reference · PositiveIntegrators.jl"/><meta property="og:title" content="API reference · PositiveIntegrators.jl"/><meta property="twitter:title" content="API reference · PositiveIntegrators.jl"/><meta name="description" content="Documentation for PositiveIntegrators.jl."/><meta property="og:description" content="Documentation for PositiveIntegrators.jl."/><meta property="twitter:description" content="Documentation for PositiveIntegrators.jl."/><meta property="og:url" content="https://SKopecz.github.io/PositiveIntegrators.jl/stable/api_reference/"/><meta property="twitter:url" content="https://SKopecz.github.io/PositiveIntegrators.jl/stable/api_reference/"/><link rel="canonical" href="https://SKopecz.github.io/PositiveIntegrators.jl/stable/api_reference/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">PositiveIntegrators.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../linear_advection/">Linear Advection</a></li></ul></li><li><a class="tocitem" href="../faq/">Troubleshooting, FAQ</a></li><li class="is-active"><a class="tocitem" href>API reference</a></li><li><a class="tocitem" href="../contributing/">Contributing</a></li><li><a class="tocitem" href="../code_of_conduct/">Code of conduct</a></li><li><a class="tocitem" href="../license/">License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API reference</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SKopecz/PositiveIntegrators.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SKopecz/PositiveIntegrators.jl/blob/main/docs/src/api_reference.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="PositiveIntegrators.jl-API"><a class="docs-heading-anchor" href="#PositiveIntegrators.jl-API">PositiveIntegrators.jl API</a><a id="PositiveIntegrators.jl-API-1"></a><a class="docs-heading-anchor-permalink" href="#PositiveIntegrators.jl-API" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PositiveIntegrators.prob_pds_bertolazzi" href="#PositiveIntegrators.prob_pds_bertolazzi"><code>PositiveIntegrators.prob_pds_bertolazzi</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">prob_pds_bertolazzi</code></pre><p>Positive and conservative autonomous nonlinear PDS</p><p class="math-container">\[\begin{aligned}
\mathbf{u}&#39;=\begin{pmatrix}2 &amp;-1 &amp;-1\\-1 &amp;2 &amp;-1\\-1&amp; -1&amp; 2\end{pmatrix}\begin{pmatrix}5u_2u_3/(10^{-2} + (u_2u_3)^2) + u_2u_3/(10^{-16} + u_2u_3(10^{-8} + u_2u_3))\\
10u_1u_3^2\\
0.1(u_3 - u_2 - 2.5)^2u_1u_2\end{pmatrix}
\end{aligned}\]</p><p>with initial value <span>$\mathbf{u}_0 = (0.0, 1.0, 2.0)^T$</span> and time domain <span>$(0.0, 1.0)$</span>. There is one independent linear invariant, e.g. <span>$u_1+u_2+u_3 = 3.0$</span>.</p><p><strong>References</strong></p><ul><li>Enrico Bertolazzi. &quot;Positive and conservative schemes for mass action kinetics.&quot; Computers and Mathematics with Applications 32 (1996): 29-43. <a href="https://doi.org/10.1016/0898-1221(96)00142-3">DOI: 10.1016/0898-1221(96)00142-3</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SKopecz/PositiveIntegrators.jl/blob/b096eda16909bf502eacd919526c36bcc4aa023e/src/PDSProblemLibrary.jl#L180-L200">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PositiveIntegrators.prob_pds_brusselator" href="#PositiveIntegrators.prob_pds_brusselator"><code>PositiveIntegrators.prob_pds_brusselator</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">prob_pds_brusselator</code></pre><p>Positive and conservative autonomous nonlinear PDS</p><p class="math-container">\[\begin{aligned}
u_1&#39; &amp;= -u_1,\\
u_2&#39; &amp;= -u_2u_5,\\
u_3&#39; &amp;= u_2u_5,\\
u_4&#39; &amp;= u_5,\\
u_5&#39; &amp;= u_1 - u_2u_5 + u_5^2u_6 - u_5,\\
u_6&#39; &amp;= u_2u_5 - u_5^2u_6,
\end{aligned}\]</p><p>with initial value <span>$\mathbf{u}_0 = (10.0, 10.0, 0.0, 0.0, 0.1, 0.1)^T$</span> and time domain <span>$(0.0, 20.0)$</span>. There are two independent linear invariants, e.g. <span>$u_1+u_4+u_5+u_6 = 10.2$</span> and <span>$u_2+u_3 = 10.0$</span>.</p><p><strong>References</strong></p><ul><li>Luca Bonaventura,  and Alessandro Della Rocca. &quot;Unconditionally Strong Stability Preserving Extensions of the TR-BDF2 Method.&quot; Journal of Scientific Computing 70 (2017): 859 - 895. <a href="https://doi.org/10.1007/s10915-016-0267-9">DOI: 10.1007/s10915-016-0267-9</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SKopecz/PositiveIntegrators.jl/blob/b096eda16909bf502eacd919526c36bcc4aa023e/src/PDSProblemLibrary.jl#L118-L141">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PositiveIntegrators.prob_pds_linmod" href="#PositiveIntegrators.prob_pds_linmod"><code>PositiveIntegrators.prob_pds_linmod</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">prob_pds_linmod</code></pre><p>Positive and conservative autonomous linear PDS</p><p class="math-container">\[\begin{aligned}
u_1&#39; &amp;= u_2 - 5u_1,\\
u_2&#39; &amp;= 5u_1 - u_2,
\end{aligned}\]</p><p>with initial value <span>$\mathbf{u}_0 = (0.9, 0.1)^T$</span> and time domain <span>$(0.0, 2.0)$</span>. There is one independent linear invariant, e.g. <span>$u_1+u_2 = 1$</span>.</p><p><strong>References</strong></p><ul><li>Hans Burchard, Eric Deleersnijder, and Andreas Meister. &quot;A high-order conservative Patankar-type discretisation for stiff systems of production-destruction equations.&quot; Applied Numerical Mathematics 47.1 (2003): 1-30. <a href="https://doi.org/10.1016/S0168-9274(03)00101-6">DOI: 10.1016/S0168-9274(03)00101-6</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SKopecz/PositiveIntegrators.jl/blob/b096eda16909bf502eacd919526c36bcc4aa023e/src/PDSProblemLibrary.jl#L12-L32">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PositiveIntegrators.prob_pds_linmod_inplace" href="#PositiveIntegrators.prob_pds_linmod_inplace"><code>PositiveIntegrators.prob_pds_linmod_inplace</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">prob_pds_linmod_inplace</code></pre><p>Same as <a href="#PositiveIntegrators.prob_pds_linmod"><code>prob_pds_linmod</code></a> but with in-place computation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SKopecz/PositiveIntegrators.jl/blob/b096eda16909bf502eacd919526c36bcc4aa023e/src/PDSProblemLibrary.jl#L41-L45">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PositiveIntegrators.prob_pds_nonlinmod" href="#PositiveIntegrators.prob_pds_nonlinmod"><code>PositiveIntegrators.prob_pds_nonlinmod</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">prob_pds_nonlinmod</code></pre><p>Positive and conservative autonomous nonlinear PDS</p><p class="math-container">\[\begin{aligned}
u_1&#39; &amp;= -\frac{u_1u_2}{u_1 + 1.0},\\
u_2&#39; &amp;= \frac{u_1u_2}{u_1 + 1.0} - 0.3u_2,\\
u_3&#39; &amp;= 0.3 u_2,
\end{aligned}\]</p><p>with initial value <span>$\mathbf{u}_0 = (9.98, 0.01, 0.01)^T$</span> and time domain <span>$(0.0, 30.0)$</span>. There is one independent linear invariant, e.g. <span>$u_1+u_2+u_3 = 10.0$</span>.</p><p><strong>References</strong></p><ul><li>Hans Burchard, Eric Deleersnijder, and Andreas Meister. &quot;A high-order conservative Patankar-type discretisation for stiff systems of production-destruction equations.&quot; Applied Numerical Mathematics 47.1 (2003): 1-30. <a href="https://doi.org/10.1016/S0168-9274(03)00101-6">DOI: 10.1016/S0168-9274(03)00101-6</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SKopecz/PositiveIntegrators.jl/blob/b096eda16909bf502eacd919526c36bcc4aa023e/src/PDSProblemLibrary.jl#L55-L76">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PositiveIntegrators.prob_pds_npzd" href="#PositiveIntegrators.prob_pds_npzd"><code>PositiveIntegrators.prob_pds_npzd</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">prob_pds_npzd</code></pre><p>Positive and conservative autonomous nonlinear PDS</p><p class="math-container">\[\begin{aligned}
u_1&#39; &amp;= 0.01u_2 + 0.01u_3 + 0.003u_4 - \frac{u_1u_2}{0.01 + u_1},\\
u_2&#39; &amp;= \frac{u_1u_2}{0.01 + u_1}- 0.01u_2 - 0.5( 1 - e^{-1.21u_2^2})u_3 - 0.05u_2,\\
u_3&#39; &amp;= 0.5(1 - e^{-1.21u_2^2})u_3 - 0.01u_3 - 0.02u_3,\\
u_4&#39; &amp;= 0.05u_2 + 0.02u_3 - 0.003u_4
\end{aligned}\]</p><p>with initial value <span>$\mathbf{u}_0 = (8.0, 2.0, 1.0, 4.0)^T$</span> and time domain <span>$(0.0, 10.0)$</span>. There is one independent linear invariant, e.g. <span>$u_1+u_2+u_3+u_4 = 15.0$</span>.</p><p><strong>References</strong></p><ul><li>Hans Burchard, Eric Deleersnijder, and Andreas Meister. &quot;Application of modified Patankar schemes to stiff biogeochemical models for the water column.&quot; Ocean Dynamics 55 (2005): 326-337. <a href="https://doi.org/10.1007/s10236-005-0001-x">DOI: 10.1007/s10236-005-0001-x</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SKopecz/PositiveIntegrators.jl/blob/b096eda16909bf502eacd919526c36bcc4aa023e/src/PDSProblemLibrary.jl#L216-L237">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PositiveIntegrators.prob_pds_robertson" href="#PositiveIntegrators.prob_pds_robertson"><code>PositiveIntegrators.prob_pds_robertson</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">prob_pds_robertson</code></pre><p>Positive and conservative autonomous nonlinear PDS</p><p class="math-container">\[\begin{aligned}
u_1&#39; &amp;= -0.04u_1+10^4 u_2u_3,\\
u_2&#39; &amp;=  0.04u_1-10^4 u_2u_3-3⋅10^7 u_2^2,\\
u_3&#39; &amp;= 3⋅10^7 u_2^2,
\end{aligned}\]</p><p>with initial value <span>$\mathbf{u}_0 = (1.0, 0.0, 0.0)^T$</span> and time domain <span>$(0.0, 10^{11})$</span>. There is one independent linear invariant, e.g. <span>$u_1+u_2+u_3 = 1.0$</span>.</p><p><strong>References</strong></p><ul><li>Ernst Hairer, Gerd Wanner. &quot;Solving Ordinary Differential Equations II - Stiff and Differential-Algebraic Problems.&quot; 2nd Edition, Springer (2002): Section IV.1.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SKopecz/PositiveIntegrators.jl/blob/b096eda16909bf502eacd919526c36bcc4aa023e/src/PDSProblemLibrary.jl#L84-L103">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PositiveIntegrators.prob_pds_sir" href="#PositiveIntegrators.prob_pds_sir"><code>PositiveIntegrators.prob_pds_sir</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">prob_pds_sir</code></pre><p>Positive and conservative autonomous nonlinear PDS</p><p class="math-container">\[\begin{aligned}
u_1&#39; &amp;= -2u_1u_2,\\
u_2&#39; &amp;= 2u_1u_2 - u_2,\\
u_3&#39; &amp;= u_2,
\end{aligned}\]</p><p>with initial value <span>$\mathbf{u}_0 = (0.99, 0.005, 0.005)^T$</span> and time domain <span>$(0.0, 20.0)$</span>. There is one independent linear invariant, e.g. <span>$u_1+u_2+u_3 = 1.0$</span>.</p><p><strong>References</strong></p><ul><li>Ronald E. Mickens, and Talitha M. Washington. &quot;NSFD discretizations of interacting population models satisfying conservation laws.&quot; Computers and Mathematics with Applications 66 (2013): 2307-2316. <a href="https://doi.org/10.1016/j.camwa.2013.06.011">DOI: 10.1016/j.camwa.2013.06.011</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SKopecz/PositiveIntegrators.jl/blob/b096eda16909bf502eacd919526c36bcc4aa023e/src/PDSProblemLibrary.jl#L147-L167">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PositiveIntegrators.prob_pds_stratreac" href="#PositiveIntegrators.prob_pds_stratreac"><code>PositiveIntegrators.prob_pds_stratreac</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">prob_pds_stratreac</code></pre><p>Positive and nonconservative autonomous nonlinear PDS</p><p class="math-container">\[\begin{aligned}
u_1&#39; &amp;= r_5 - r_6 -  r_7,\\
u_2&#39; &amp;= 2r_1 - r_2 + r_3 - r_4 + r_6 - r_9 + r_{10} - r_{11},\\
u_3&#39; &amp;= r_2 - r_3 - r_4 - r_5 - r_7 - r_8,\\
u_4&#39; &amp;= -r_1 -r_2 + r_3 + 2r_4+r_5+2r_7+r_8+r_9,\\
u_5&#39; &amp;= -r_8+r_9+r_{10}-r_{11},\\
u_6&#39; &amp;= r_8-r_9-r_{10}+r_{11},
\end{aligned}\]</p><p>with reaction rates</p><p class="math-container">\[\begin{aligned}
r_1 &amp;=2.643⋅ 10^{-10}σ^3 u_4, &amp; r_2 &amp;=8.018⋅10^{-17}u_2 u_4 , &amp; r_3 &amp;=6.12⋅10^{-4}σ u_3,\\
r_4 &amp;=1.567⋅10^{-15}u_3 u_2 , &amp; r_5 &amp;= 1.07⋅ 10^{-3}σ^2u_3,  &amp; r_6 &amp;= 7.11⋅10^{-11}⋅ 8.12⋅10^6 u_1,\\
r_7 &amp;= 1.2⋅10^{-10}u_1 u_3, &amp; r_8 &amp;= 6.062⋅10^{-15}u_3 u_5, &amp; r_9 &amp;= 1.069⋅10^{-11}u_6 u_2,\\
r_{10} &amp;= 1.289⋅10^{-2}σ u_6, &amp; r_{11} &amp;= 10^{-8}u_5 u_2,
\end{aligned}\]</p><p>where</p><p class="math-container">\[\begin{aligned}
T &amp;= t/3600 \mod 24,\quad T_r=4.5,\quad T_s = 19.5,\\
σ(T) &amp;= \begin{cases}1, &amp; T_r≤ T≤ T_s,\\0, &amp; \text{otherwise}.\end{cases}
\end{aligned}\]</p><p>The initial value is <span>$\mathbf{u}_0 = (9.906⋅10^1, 6.624⋅10^8, 5.326⋅10^{11}, 1.697⋅10^{16}, 4⋅10^6, 1.093⋅10^9)^T$</span> and the time domain <span>$(4.32⋅ 10^{4}, 3.024⋅10^5)$</span>. There are two independent linear invariants, e.g. <span>$u_1+u_2+3u_3+2u_4+u_5+2u_6=(1,1,3,2,1,2)\cdot\mathbf{u}_0$</span> and <span>$u_5+u_6 = 1.097⋅10^9$</span>.</p><p><strong>References</strong></p><ul><li>Stephan Nüsslein, Hendrik Ranocha, and David I. Ketcheson. &quot;Positivity-preserving adaptive Runge-Kutta methods.&quot; Communications in Applied Mathematics and Computer Science 16 (2021): 155-179. <a href="https://doi.org/10.2140/camcos.2021.16.155">DOI: 10.2140/camcos.2021.16.155</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SKopecz/PositiveIntegrators.jl/blob/b096eda16909bf502eacd919526c36bcc4aa023e/src/PDSProblemLibrary.jl#L299-L339">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PositiveIntegrators.ConservativePDSProblem" href="#PositiveIntegrators.ConservativePDSProblem"><code>PositiveIntegrators.ConservativePDSProblem</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ConservativePDSProblem(P, u0, tspan, p = NullParameters();
                       p_prototype = nothing,
                       analytic = nothing)</code></pre><p>A structure describing a conservative system of ordinary differential equation in form of a production-destruction system (PDS). <code>P</code> denotes the production matrix. <code>u0</code> is the vector of initial conditions and <code>tspan</code> the time span <code>(t_initial, t_final)</code> of the problem. The optional argument <code>p</code> can be used to pass additional parameters to the function P.</p><p>The function <code>P</code> can be given either in the out-of-place form with signature <code>production_terms = P(u, p, t)</code> or the in-place form <code>P(production_terms, u, p, t)</code>.</p><p><strong>Keyword arguments:</strong></p><ul><li><code>p_prototype</code>: If <code>P</code> is given in in-place form, <code>p_prototype</code> is used to store evaluations of <code>P</code>.   If <code>p_prototype</code> is not specified explicitly and <code>P</code> is in-place, then <code>p_prototype</code> will be internally set to <code>zeros(eltype(u0), (length(u0), length(u0)))</code>.</li><li><code>analytic</code>: The analytic solution of a PDS must be given in the form <code>f(u0,p,t)</code>.   Specifying the analytic solution can be useful for plotting and convergence tests.</li></ul><p><strong>References</strong></p><ul><li>Hans Burchard, Eric Deleersnijder, and Andreas Meister. &quot;A high-order conservative Patankar-type discretisation for stiff systems of production-destruction equations.&quot; Applied Numerical Mathematics 47.1 (2003): 1-30. <a href="https://doi.org/10.1016/S0168-9274(03)00101-6">DOI: 10.1016/S0168-9274(03)00101-6</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SKopecz/PositiveIntegrators.jl/blob/b096eda16909bf502eacd919526c36bcc4aa023e/src/proddest.jl#L164-L193">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PositiveIntegrators.MPE" href="#PositiveIntegrators.MPE"><code>PositiveIntegrators.MPE</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">MPE([linsolve = ..., small_constant = ...])</code></pre><p>The first-order modified Patankar-Euler algorithm for production-destruction systems. This one-step, one-stage method is first-order accurate, unconditionally positivity-preserving, and linearly implicit.</p><p>The scheme was introduced by Burchard et al. for conservative production-destruction systems. For nonconservative production–destruction systems we use the straight forward extension</p><p><span>$u_i^{n+1} = u_i^n + Δt \sum_{j, j≠i} \biggl(p_{ij}^n \frac{u_j^{n+1}}{u_j^n}-d_{ij}^n \frac{u_i^{n+1}}{u_i^n}\biggr) + {\Delta}t p_{ii}^n - Δt d_{ii}^n\frac{u_i^{n+1}}{u_i^n}$</span>,</p><p>where <span>$p_{ij}^n = p_{ij}(t^n,\mathbf u^n)$</span> and <span>$d_{ij}^n = d_{ij}(t^n,\mathbf u^n)$</span>.</p><p>The modified Patankar-Euler method requires the special structure of a <a href="#PositiveIntegrators.PDSProblem"><code>PDSProblem</code></a> or a <a href="#PositiveIntegrators.ConservativePDSProblem"><code>ConservativePDSProblem</code></a>.</p><p>You can optionally choose the linear solver to be used by passing an algorithm from <a href="https://github.com/SciML/LinearSolve.jl">LinearSolve.jl</a> as keyword argument <code>linsolve</code>. You can also choose the parameter <code>small_constant</code> which is added to all Patankar-weight denominators to avoid divisions by zero. You can pass a value explicitly, otherwise <code>small_constant</code> is set to <code>floatmin</code> of the floating point type used.</p><p>The current implementation only supports fixed time steps.</p><p><strong>References</strong></p><ul><li>Hans Burchard, Eric Deleersnijder, and Andreas Meister. &quot;A high-order conservative Patankar-type discretisation for stiff systems of production-destruction equations.&quot; Applied Numerical Mathematics 47.1 (2003): 1-30. <a href="https://doi.org/10.1016/S0168-9274(03)00101-6">DOI: 10.1016/S0168-9274(03)00101-6</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SKopecz/PositiveIntegrators.jl/blob/b096eda16909bf502eacd919526c36bcc4aa023e/src/mprk.jl#L221-L253">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PositiveIntegrators.MPRK22" href="#PositiveIntegrators.MPRK22"><code>PositiveIntegrators.MPRK22</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">MPRK22(α; [linsolve = ..., small_constant = ...])</code></pre><p>A family of second-order modified Patankar-Runge-Kutta algorithms for production-destruction systems. Each member of this family is an adaptive, one-step, two-stage method which is second-order accurate, unconditionally positivity-preserving, and linearly implicit. In this implementation the stage-values are conservative as well. The parameter <code>α</code> is described by Kopecz and Meister (2018) and studied by Izgin, Kopecz and Meister (2022) as well as Torlo, Öffner and Ranocha (2022).</p><p>This method supports adaptive time stepping, using the Patankar-weight denominators <span>$σ_i$</span>, see Kopecz and Meister (2018), as first order approximations to estimate the error.</p><p>The scheme was introduced by Kopecz and Meister for conservative production-destruction systems. For nonconservative production–destruction systems we use a straight forward extension analogous to <a href="#PositiveIntegrators.MPE"><code>MPE</code></a>.</p><p>This modified Patankar-Runge-Kutta method requires the special structure of a <a href="#PositiveIntegrators.PDSProblem"><code>PDSProblem</code></a> or a <a href="#PositiveIntegrators.ConservativePDSProblem"><code>ConservativePDSProblem</code></a>.</p><p>You can optionally choose the linear solver to be used by passing an algorithm from <a href="https://github.com/SciML/LinearSolve.jl">LinearSolve.jl</a> as keyword argument <code>linsolve</code>. You can also choose the parameter <code>small_constant</code> which is added to all Patankar-weight denominators to avoid divisions by zero. You can pass a value explicitly, otherwise <code>small_constant</code> is set to <code>floatmin</code> of the floating point type used.</p><p><strong>References</strong></p><ul><li>Hans Burchard, Eric Deleersnijder, and Andreas Meister. &quot;A high-order conservative Patankar-type discretisation for stiff systems of production-destruction equations.&quot; Applied Numerical Mathematics 47.1 (2003): 1-30. <a href="https://doi.org/10.1016/S0168-9274(03)00101-6">DOI: 10.1016/S0168-9274(03)00101-6</a></li><li>Stefan Kopecz and Andreas Meister. &quot;On order conditions for modified Patankar-Runge-Kutta schemes.&quot; Applied Numerical Mathematics 123 (2018): 159-179. <a href="https://doi.org/10.1016/j.apnum.2017.09.004">DOI: 10.1016/j.apnum.2017.09.004</a></li><li>Thomas Izgin, Stefan Kopecz, and Andreas Meister. &quot;On Lyapunov stability of positive and conservative time integrators and application to second order modified Patankar-Runge-Kutta schemes.&quot; ESAIM: Mathematical Modelling and Numerical Analysis 56.3 (2022): 1053-1080. <a href="https://doi.org/10.1051/m2an/2022031">DOI: 10.1051/m2an/2022031</a></li><li>Davide Torlo, Philipp Öffner, and Hendrik Ranocha. &quot;Issues with positivity-preserving Patankar-type schemes.&quot; Applied Numerical Mathematics 182 (2022): 117-147. <a href="https://doi.org/10.1016/j.apnum.2022.07.014">DOI: 10.1016/j.apnum.2022.07.014</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SKopecz/PositiveIntegrators.jl/blob/b096eda16909bf502eacd919526c36bcc4aa023e/src/mprk.jl#L434-L482">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PositiveIntegrators.MPRK43I" href="#PositiveIntegrators.MPRK43I"><code>PositiveIntegrators.MPRK43I</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">MPRK43I(α, β; [linsolve = ..., small_constant = ...])</code></pre><p>A family of third-order modified Patankar-Runge-Kutta schemes for production-destruction systems, which is based on the two-parameter family of third order explicit Runge–Kutta schemes. Each member of this family is an adaptive, one-step method with four-stages which is third-order accurate, unconditionally positivity-preserving, conservative and linearly implicit. In this implementation the stage-values are conservative as well. The parameters <code>α</code> and <code>β</code> must be chosen such that the Runge–Kutta coefficients are nonnegative, see Kopecz and Meister (2018) for details.</p><p>These methods support adaptive time stepping, using the Patankar-weight denominators <span>$σ_i$</span>, see Kopecz and Meister (2018), as second order approximations to estimate the error.</p><p>The scheme was introduced by Kopecz and Meister for conservative production-destruction systems. For nonconservative production–destruction systems we use the straight forward extension analogous to <a href="#PositiveIntegrators.MPE"><code>MPE</code></a>.</p><p>These modified Patankar-Runge-Kutta methods require the special structure of a <a href="#PositiveIntegrators.PDSProblem"><code>PDSProblem</code></a> or a <a href="#PositiveIntegrators.ConservativePDSProblem"><code>ConservativePDSProblem</code></a>.</p><p>You can optionally choose the linear solver to be used by passing an algorithm from <a href="https://github.com/SciML/LinearSolve.jl">LinearSolve.jl</a> as keyword argument <code>linsolve</code>. You can also choose the parameter <code>small_constant</code> which is added to all Patankar-weight denominators to avoid divisions by zero. You can pass a value explicitly, otherwise <code>small_constant</code> is set to <code>floatmin</code> of the floating point type used.</p><p><strong>References</strong></p><ul><li>Stefan Kopecz and Andreas Meister. &quot;Unconditionally positive and conservative third order modified Patankar–Runge–Kutta  discretizations of production–destruction systems.&quot;  BIT Numerical Mathematics 58 (2018): 691–728. <a href="https://doi.org/10.1007/s10543-018-0705-1">DOI: 10.1007/s10543-018-0705-1</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SKopecz/PositiveIntegrators.jl/blob/b096eda16909bf502eacd919526c36bcc4aa023e/src/mprk.jl#L856-L891">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PositiveIntegrators.MPRK43II" href="#PositiveIntegrators.MPRK43II"><code>PositiveIntegrators.MPRK43II</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">MPRK43II(γ; [linsolve = ..., small_constant = ...])</code></pre><p>A family of third-order modified Patankar-Runge-Kutta schemes for production-destruction systems, which is based on the one-parameter family of third order explicit Runge–Kutta schemes with non-negative Runge–Kutta coefficients. Each member of this family is an adaptive, one-step method with four stages which is third-order accurate, unconditionally positivity-preserving, conservative and linearly implicit. In this implementation the stage-values are conservative as well. The parameter <code>γ</code> must satisfy <code>3/8 ≤ γ ≤ 3/4</code>. Further details are given in Kopecz and Meister (2018).</p><p>This method supports adaptive time stepping, using the Patankar-weight denominators <span>$σ_i$</span>, see Kopecz and Meister (2018), as second order approximations to estimate the error.</p><p>The scheme was introduced by Kopecz and Meister for conservative production-destruction systems. For nonconservative production–destruction systems we use the straight forward extension analogous to <a href="#PositiveIntegrators.MPE"><code>MPE</code></a>.</p><p>These modified Patankar-Runge-Kutta methods require the special structure of a <a href="#PositiveIntegrators.PDSProblem"><code>PDSProblem</code></a> or a <a href="#PositiveIntegrators.ConservativePDSProblem"><code>ConservativePDSProblem</code></a>.</p><p>You can optionally choose the linear solver to be used by passing an algorithm from <a href="https://github.com/SciML/LinearSolve.jl">LinearSolve.jl</a> as keyword argument <code>linsolve</code>. You can also choose the parameter <code>small_constant</code> which is added to all Patankar-weight denominators to avoid divisions by zero. You can pass a value explicitly, otherwise <code>small_constant</code> is set to <code>floatmin</code> of the floating point type used.</p><p><strong>References</strong></p><ul><li>Stefan Kopecz and Andreas Meister. &quot;Unconditionally positive and conservative third order modified Patankar–Runge–Kutta  discretizations of production–destruction systems.&quot;  BIT Numerical Mathematics 58 (2018): 691–728. <a href="https://doi.org/10.1007/s10543-018-0705-1">DOI: 10.1007/s10543-018-0705-1</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SKopecz/PositiveIntegrators.jl/blob/b096eda16909bf502eacd919526c36bcc4aa023e/src/mprk.jl#L958-L994">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PositiveIntegrators.PDSProblem" href="#PositiveIntegrators.PDSProblem"><code>PositiveIntegrators.PDSProblem</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">PDSProblem(P, D, u0, tspan, p = NullParameters();
           p_prototype = nothing,
           d_prototype = nothing,
           analytic = nothing)</code></pre><p>A structure describing a system of ordinary differential equations in form of a production-destruction system (PDS). <code>P</code> denotes the production matrix. The diagonal of <code>P</code> contains production terms without destruction counterparts. <code>D</code> is the vector of destruction terms without production counterparts. <code>u0</code> is the vector of initial conditions and <code>tspan</code> the time span <code>(t_initial, t_final)</code> of the problem. The optional argument <code>p</code> can be used to pass additional parameters to the functions <code>P</code> and <code>D</code>.</p><p>The functions <code>P</code> and <code>D</code> can be used either in the out-of-place form with signature <code>production_terms = P(u, p, t)</code> or the in-place form <code>P(production_terms, u, p, t)</code>.</p><p><strong>Keyword arguments:</strong></p><ul><li><code>p_prototype</code>: If <code>P</code> is given in in-place form, <code>p_prototype</code> is used to store evaluations of <code>P</code>.   If <code>p_prototype</code> is not specified explicitly and <code>P</code> is in-place, then <code>p_prototype</code> will be internally set to <code>zeros(eltype(u0), (length(u0), length(u0)))</code>.</li><li><code>d_prototype</code>: If <code>D</code> is given in in-place form, <code>d_prototype</code> is used to store evaluations of <code>D</code>. If <code>d_prototype</code> is not specified explicitly and <code>D</code> is in-place, then <code>d_prototype</code> will be internally</li></ul><p>set to <code>zeros(eltype(u0), (length(u0),))</code>.</p><ul><li><code>analytic</code>: The analytic solution of a PDS must be given in the form <code>f(u0,p,t)</code>.   Specifying the analytic solution can be useful for plotting and convergence tests.</li></ul><p><strong>References</strong></p><ul><li>Hans Burchard, Eric Deleersnijder, and Andreas Meister. &quot;A high-order conservative Patankar-type discretisation for stiff systems of production-destruction equations.&quot; Applied Numerical Mathematics 47.1 (2003): 1-30. <a href="https://doi.org/10.1016/S0168-9274(03)00101-6">DOI: 10.1016/S0168-9274(03)00101-6</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SKopecz/PositiveIntegrators.jl/blob/b096eda16909bf502eacd919526c36bcc4aa023e/src/proddest.jl#L4-L40">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PositiveIntegrators.SSPMPRK22" href="#PositiveIntegrators.SSPMPRK22"><code>PositiveIntegrators.SSPMPRK22</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SSPMPRK22(α, β; [linsolve = ..., small_constant = ...])</code></pre><p>A family of second-order modified Patankar-Runge-Kutta algorithms for production-destruction systems. Each member of this family is an adaptive, one-step, two-stage method which is second-order accurate, unconditionally positivity-preserving, and linearly implicit. The parameters <code>α</code> and <code>β</code> are described by Huang and Shu (2019) and studied by Huang, Izgin, Kopecz, Meister and Shu (2023). The difference to <a href="#PositiveIntegrators.MPRK22"><code>MPRK22</code></a> is that this method is based on the SSP formulation of an explicit second-order Runge-Kutta method. This family of schemes contains the <a href="#PositiveIntegrators.MPRK22"><code>MPRK22</code></a> family, where <code>MPRK22(α) = SSMPRK22(0, α)</code> applies.</p><p>This method supports adaptive time stepping, using the first order approximations <span>$(σ_i - u_i^n) / τ + u_i^n$</span> with <span>$τ=1+(α_{21}β_{10}^2)/(β_{20}+β_{21})$</span>, see (2.7) in Huang and Shu (2019), to estimate the error.</p><p>The scheme was introduced by Huang and Shu for conservative production-destruction systems. For nonconservative production–destruction systems we use the straight forward extension analogous to <a href="#PositiveIntegrators.MPE"><code>MPE</code></a>.</p><p>This modified Patankar-Runge-Kutta method requires the special structure of a <a href="#PositiveIntegrators.PDSProblem"><code>PDSProblem</code></a> or a <a href="#PositiveIntegrators.ConservativePDSProblem"><code>ConservativePDSProblem</code></a>.</p><p>You can optionally choose the linear solver to be used by passing an algorithm from <a href="https://github.com/SciML/LinearSolve.jl">LinearSolve.jl</a> as keyword argument <code>linsolve</code>. You can also choose the parameter <code>small_constant</code> which is added to all Patankar-weight denominators to avoid divisions by zero. You can pass a value explicitly, otherwise <code>small_constant</code> is set to <code>floatmin</code> of the floating point type used.</p><p><strong>References</strong></p><ul><li>Juntao Huang and Chi-Wang Shu. &quot;Positivity-Preserving Time Discretizations for Production–Destruction Equations with Applications to Non-equilibrium Flows.&quot; Journal of Scientific Computing 78 (2019): 1811–1839 <a href="https://doi.org/10.1007/s10915-018-0852-1">DOI: 10.1007/s10915-018-0852-1</a></li><li>Juntao Huang, Thomas Izgin, Stefan Kopecz, Andreas Meister and Chi-Wang Shu. &quot;On the stability of strong-stability-preserving modified Patankar-Runge-Kutta schemes.&quot; ESAIM: Mathematical Modelling and Numerical Analysis 57 (2023):1063–1086 <a href="https://doi.org/10.1051/m2an/2023005">DOI: 10.1051/m2an/2023005</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SKopecz/PositiveIntegrators.jl/blob/b096eda16909bf502eacd919526c36bcc4aa023e/src/sspmprk.jl#L2-L43">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PositiveIntegrators.SSPMPRK43" href="#PositiveIntegrators.SSPMPRK43"><code>PositiveIntegrators.SSPMPRK43</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SSPMPRK43([linsolve = ..., small_constant = ...])</code></pre><p>A third-order modified Patankar-Runge-Kutta algorithm for production-destruction systems. This scheme is a one-step, four-stage method which is third-order accurate, unconditionally positivity-preserving, and linearly implicit. The scheme is described by Huang, Zhao and Shu (2019) and studied by Huang, Izgin, Kopecz, Meister and Shu (2023). The difference to <a href="#PositiveIntegrators.MPRK43I"><code>MPRK43I</code></a> or <a href="#PositiveIntegrators.MPRK43II"><code>MPRK43II</code></a> is that this method is based on the SSP formulation of an explicit third-order Runge-Kutta method.</p><p>The scheme was introduced by Huang, Zhao and Shu for conservative production-destruction systems. For nonconservative production–destruction systems we use the straight forward extension analogous to <a href="#PositiveIntegrators.MPE"><code>MPE</code></a>.</p><p>This modified Patankar-Runge-Kutta method requires the special structure of a <a href="#PositiveIntegrators.PDSProblem"><code>PDSProblem</code></a> or a <a href="#PositiveIntegrators.ConservativePDSProblem"><code>ConservativePDSProblem</code></a>.</p><p>You can optionally choose the linear solver to be used by passing an algorithm from <a href="https://github.com/SciML/LinearSolve.jl">LinearSolve.jl</a> as keyword argument <code>linsolve</code>. You can also choose the parameter <code>small_constant</code> which is added to all Patankar-weight denominators to avoid divisions by zero. You can pass a value explicitly, otherwise <code>small_constant</code> is set to <code>floatmin</code> of the floating point type used.</p><p>The current implementation only supports fixed time steps.</p><p><strong>References</strong></p><ul><li>Juntao Huang, Weifeng Zhao and Chi-Wang Shu. &quot;A Third-Order Unconditionally Positivity-Preserving Scheme for Production–Destruction Equations with Applications to Non-equilibrium Flows.&quot; Journal of Scientific Computing 79 (2019): 1015–1056 <a href="https://doi.org/10.1007/s10915-018-0881-9">DOI: 10.1007/s10915-018-0881-9</a></li><li>Juntao Huang, Thomas Izgin, Stefan Kopecz, Andreas Meister and Chi-Wang Shu. &quot;On the stability of strong-stability-preserving modified Patankar-Runge-Kutta schemes.&quot; ESAIM: Mathematical Modelling and Numerical Analysis 57 (2023):1063–1086 <a href="https://doi.org/10.1051/m2an/2023005">DOI: 10.1051/m2an/2023005</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SKopecz/PositiveIntegrators.jl/blob/b096eda16909bf502eacd919526c36bcc4aa023e/src/sspmprk.jl#L447-L485">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../faq/">« Troubleshooting, FAQ</a><a class="docs-footer-nextpage" href="../contributing/">Contributing »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Thursday 18 July 2024 13:28">Thursday 18 July 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
